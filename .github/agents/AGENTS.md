---
name: AGENTS
description: 全てのカスタムエージェントの共通ガイドライン
tools: ['execute', 'read', 'edit', 'search', 'web', 'agent', 'todo']
---

# 実行ルール（最初に必ず）
- 開始前に「主要ステップのチェックリスト（5〜20項目）」を箇条書きで提示（概念レベル）。
- Planner 形式に沿って **実行プラン（見積りX–Y分/合計）** を出す。
  - 合計見積りが **10分を超える場合は実装/編集に入らず**、分割案（サブタスク案）を提示して停止する。
  - サブタスクは、**同じファイルに書き込まない/1つのサブタスクの成果物が論理的に分割されない**単位の並列実行が可能な作業にすること。
  - 各サブタスクの実行用のPromptを作成する
  - 各サブタスクのPromptは、親Issue参照行を含めて `work/{ユースケースID}/<Issue名>-<番号>.md`の様なファイルに保存する。このファイル名はサブタスクのファイルの保存の指定がなかった場合に使用する。

## Planner 形式
- Goal（1行）
- Plan（各行：- [ ] step (X–Y min)）
- Dependencies（Inputs/Outputs paths）
- Parallelism（並列/直列の根拠）
- Risks & Checks（検証観点/コマンド）
- Questions（最大3、無ければNone）

# レビュールール（最後に必ず）
- タスクが完了後、成果物を論理的に分析して、ゴールが達成できたかの問題点を10-30リストアップをする。
- その問題点から、改善点を作成する。
- 改善点をもとに、全ての情報を完全版に修正をする。
- 完全版のみファイルに保存をする。

# 書き込みエラー対策（分割が必要な場合のみ）
- 一括保存で内容が空になる等の失敗が起きた場合：
  - まず truncate してマーカー付きの最小骨格を書き込む
  - 次に生成本文を 10,000 文字以下に分割して順に追記
  - 最後に読み戻して整合性チェック（空でない/表/mermaidが存在）